 100 REM BASIC Week 5: Winchester Drive 110 REM http://reddit.com/r/RetroBattlestations 120 REM written by FozzTexx 130 REM Amstrad CPC version by gschizas 200 DEFINT a-z:GOSUB 3010:GOSUB 2010 210 x=w/2-1:y=h/2-1:fc=0:fl=fc 220 GOSUB 1010 230 nx=x:ny=y 240 ke$="":WHILE ke$="":ke$=INKEY$:WEND 260 IF INSTR(CHR$(240)+CHR$(244)+CHR$(248),ke$)>0 THEN ny=y-1:fc=INT(fc/2)*2+1:IF ny<0 THEN ny=0:IF nx=w/2-1 AND MID$(dr$,1,1)<>" " THEN GOSUB 2010:nx=w/2-1:ny=h-2:GOTO 320 270 IF INSTR(CHR$(242)+CHR$(246)+CHR$(250),ke$)>0 THEN nx=x-1:fc=fc-INT(fc/2)*2+2:IF nx<0 THEN nx=0:IF ny=h/2-1 AND MID$(dr$,3,1)<>" " THEN GOSUB 2010:nx=w-2:ny=h/2-1:GOTO 320 280 IF INSTR(CHR$(243)+CHR$(247)+CHR$(251),ke$)>0 THEN nx=x+1:fc=fc-INT(fc/2)*2:IF nx>w-2 THEN nx=w-2:IF ny=h/2-1 AND MID$(dr$,4,1)<>" " THEN GOSUB 2010:nx=0:ny=h/2-1:GOTO 320 290 IF INSTR(CHR$(241)+CHR$(245)+CHR$(249),ke$)>0 THEN ny=y+1:fc=INT(fc/2)*2:IF ny>h-2 THEN ny=h-2:IF nx=w/2-1 AND MID$(dr$,2,1)<>" " THEN GOSUB 2010:nx=w/2-1:ny=0:GOTO 320 300 IF nx=x AND ny=y THEN 230  310 GOSUB 1510 320 x=nx:y=ny:fl=fc:GOSUB 1010 330 GOTO 230 1000 REM Draw character 1010 xp=x*16+8+xo:yp=y*16+8+yo 1020 ON fc+1 GOTO 1030,1080,1130,1180 1030 GRAPHICS PEN 1,1:MOVE xp,yp:PRINT#7,CHR$(192); 1040 GRAPHICS PEN 2,1:MOVE xp,yp:PRINT#7,CHR$(200);:MOVE xp,yp-16:PRINT#7,CHR$(201); 1050 GRAPHICS PEN 3,1:MOVE xp,yp-16:PRINT#7,CHR$(196); 1060 GRAPHICS PEN 4,1:MOVE xp,yp-16:PRINT#7,CHR$(206); 1070 RETURN  1080 GRAPHICS PEN 1,1:MOVE xp,yp:PRINT#7,CHR$(194); 1090 GRAPHICS PEN 2,1:MOVE xp,yp:PRINT#7,CHR$(203);:MOVE xp,yp-16:PRINT#7,CHR$(204); 1100 GRAPHICS PEN 3,1:MOVE xp,yp-16:PRINT#7,CHR$(198); 1110 GRAPHICS PEN 4,1:MOVE xp,yp-16:PRINT#7,CHR$(208); 1120 RETURN  1130 GRAPHICS PEN 1,1:MOVE xp,yp:PRINT#7,CHR$(193); 1140 GRAPHICS PEN 2,1:MOVE xp,yp-16:PRINT#7,CHR$(202); 1150 GRAPHICS PEN 3,1:MOVE xp,yp-16:PRINT#7,CHR$(197); 1160 GRAPHICS PEN 4,1:MOVE xp,yp-16:PRINT#7,CHR$(207); 1170 RETURN  1180 GRAPHICS PEN 1,1:MOVE xp,yp:PRINT#7,CHR$(195); 1190 GRAPHICS PEN 2,1:MOVE xp,yp-16:PRINT#7,CHR$(205); 1200 GRAPHICS PEN 3,1:MOVE xp,yp-16:PRINT#7,CHR$(199); 1210 GRAPHICS PEN 4,1:MOVE xp,yp-16:PRINT#7,CHR$(209); 1220 RETURN  1500 REM Erase character  1510 xp=x*16+8+xo:yp=y*16+8+yo 1520 GRAPHICS PEN 0,0:MOVE xp,yp:PRINT #7,CHR$(32);:MOVE xp,yp-16:PRINT #7,CHR$(32);:RETURN 2000 REM Create room 2010 MODE 0:PRINT CHR$(22)+"1":BORDER 0:INK 0,0:INK 1,15:INK 2,26:INK 3,18:INK 4,2:TAG #7 2020 w=INT(RND(1)*4)*2+6:h=INT(RND(1)*4)*2+6 2030 cn=INT(RND(1)*3) 2040 xo=(280-w*16)/2:yo=(192-h*16)/2 2050 wc=1+INT(RND(1)*4):IF wc > 2 THEN wc=wc+2 2060 GRAPHICS PEN wc 2070 FOR i=0 TO 3 2080 MOVE xo+16,yo+i:DRAW xo+(w-1)*16,yo+i 2090 MOVE xo+16,yo+i+h*16-4:DRAW xo+(w-1)*16,yo+i+h*16-4 2100 MOVE xo+i,yo+16:DRAW xo+i,yo+(h-1)*16 2110 MOVE xo+i+w*16-4,yo+16:DRAW xo+i+w*16-4,yo+(h-1)*16 2120 NEXT  2130 'ROT=48:DRAW cn+13 AT xo,yo+15:ROT=32:DRAW cn+13 AT xo+15,yo+h*16-1 2140 'ROT=16:DRAW cn+13 AT xo+w*16-1,yo+(h-1)*16:ROT=0:DRAW cn+13 AT xo+(w-1)*16,yo 2150 dr=1+INT(RND(1)*14) 2160 dr$="":dd$=" N S W E" 2170 FOR i=1 TO 4 2180 dd=dr-INT(dr/2)*2:dr=INT(dr/2):dr$=dr$+MID$(dd$,i*2-1+dd,1) 2190 IF dd=0 THEN 2420 2200 ns=-(i<3):s=i=2:e=i=4 2230 FOR j=0 TO 3 2240 GRAPHICS PEN INT(wc/4)*4 2250 x1=(w*16/(ns+1))*(ns+e)-12*ns-4*e+j*(1-ns) 2260 x2=(w*16/(ns+1))*(ns+e)+11*ns-4*e+j*(1-ns) 2270 y1=(h*16/((1-ns)+1))*((1-ns)+s)-12*(1-ns)-4*s+j*ns 2280 y2=(h*16/((1-ns)+1))*((1-ns)+s)+11*(1-ns)-4*s+j*ns 2290 MOVE xo+x1,yo+y1:DRAW xo+x2,yo+y2 2300 GRAPHICS PEN INT(wc/4)*4+3 2310 x1=(w*16/(ns+1))*(ns+e)-16*ns-8*e+j*ns 2320 x2=(w*16/(ns+1))*(ns+e)-16*ns-8*e+7*(1-ns)+j*ns 2330 y1=(h*16/(1-ns+1))*(1-ns+s)-16*(1-ns)-8*s+j*(1-ns) 2340 y2=(h*16/(1-ns+1))*(1-ns+s)-16*(1-ns)-8*s+7*ns+j*(1-ns) 2350 MOVE xo+x1,yo+y1:DRAW xo+x2,yo+y2 2360 x1=(w*16/(ns+1))*(ns+e)+12*ns-8*e+j*ns 2370 x2=(w*16/(ns+1))*(ns+e)+12*ns-8*e+7*(1-ns)+j*ns 2380 y1=(h*16/(1-ns+1))*(1-ns+s)+12*(1-ns)-8*s+j*(1-ns) 2390 y2=(h*16/(1-ns+1))*(1-ns+s)+12*(1-ns)-8*s+7*ns+j*(1-ns) 2400 MOVE xo+x1,yo+y1:DRAW xo+x2,yo+y2 2410 NEXT j 2420 NEXT i 2430 RETURN  3000 REM Load shape table 3010 PRINT "Loading shape table..." 3020 SYMBOL AFTER 192 3030 SYMBOL 192,14,127,255,224,224,192,192,64' RIGHT FRONT HAIR 3040 SYMBOL 193,14,127,255,254,254,254,254,124' RIGHT BACK HAIR 3050 SYMBOL 194,112,254,255,7,7,3,3,2' LEFT FRONT HAIR 3060 SYMBOL 195,112,254,255,127,127,127,127,62' LEFT BACK HAIR 3070 SYMBOL 196,104,104,56,56,0,0,0,0' RIGHT FRONT SHIRT 3080 SYMBOL 197,120,120,112,112,0,0,0,0' RIGHT BACK SHIRT 3090 SYMBOL 198,22,22,28,28,0,0,0,0' LEFT FRONT SHIRT 3100 SYMBOL 199,30,30,14,14,0,0,0,0' LEFT BACK SHIRT 3110 SYMBOL 200,0,0,0,31,21,53,63,60' RIGHT FACE 3120 SYMBOL 201,16,16,64,64,16,0,0,0' RIGHT FRONT BODY 3130 SYMBOL 202,0,0,8,8,0,0,0,0' RIGHT BACK BODY 3140 SYMBOL 203,0,0,0,248,168,172,252,60' LEFT FACE 3150 SYMBOL 204,8,8,2,2,8,0,0,0' LEFT FRONT BODY 3160 SYMBOL 205,0,0,16,16,0,0,0,0' LEFT BACK BODY 3170 SYMBOL 206,0,0,0,0,104,120,120,120' RIGHT FRONT LEGS 3180 SYMBOL 207,0,0,0,0,120,120,120,120' RIGHT BACK LEGS 3190 SYMBOL 208,0,0,0,0,22,30,30,30' LEFT FRONT LEGS 3200 SYMBOL 209,0,0,0,0,30,30,30,30' LEFT BACK LEGS 3210 RETURN